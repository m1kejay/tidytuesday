---
title: "Week 2020/51: Ninja Warrior"
output: github_document
---

```{r import}
library(magrittr)
library(tidyverse)

df <- tidytuesdayR::tt_load(2020, week = 51)
df <- df$ninja_warrior
```

```{r}
df
```



```{r}
unique(df$season)
```


```{r}
unique(df$location)
```


```{r}
df <- df %>%
  mutate(location = case_when(grepl("Japan", location) ~ "Japan", 
                              location == "San Pedro (Military)" ~ "San Pedro",
                               TRUE ~ location)) 

```

```{r}
```

```{r fig.height = 8, fig.width = 6}
df %>%
  count(obstacle_name, name = "count") %>%
  arrange(desc(count)) %>%
  slice_max(count, n = 20) %>%
  ggplot(aes(y = fct_reorder(obstacle_name, count), x = count)) +
  geom_col() +
  theme_minimal() +
  labs(
    title = "Most popular obstacles",
    x = "Count",
    y = "Obstacle"
  )

```

```{r}
# Where are the different obstacles?
df %>%
  count(obstacle_order, obstacle_name, name = "count") %>%
  arrange(obstacle_order, desc(count)) %>%
  group_by(obstacle_order) %>%
  mutate(obstacle_name = fct_lump_n(f = obstacle_name, w = count, n = 5)
```



